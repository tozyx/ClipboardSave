plugins {
    id 'java'
}

group 'com.tozyx'
version '1.0-SNAPSHOT'

repositories {
    mavenCentral()
}

jar {
    manifest {
        attributes 'Main-Class': 'ClipboardSave.Main'
    }
    // 关键步骤：将所有运行时依赖打包进 JAR
    from {
        configurations.runtimeClasspath.collect { it.isDirectory() ? it : zipTree(it) }
    }

    // 排除依赖包中的签名文件，否则运行会报 SecurityException
    duplicatesStrategy = DuplicatesStrategy.EXCLUDE
    exclude 'META-INF/*.SF', 'META-INF/*.DSA', 'META-INF/*.RSA'
}

dependencies {
    // JNA 核心库
    implementation 'net.java.dev.jna:jna:5.13.0'
    // JNA 平台库（包含 Windows 常用 API 映射）
    implementation 'net.java.dev.jna:jna-platform:5.13.0'

    testImplementation platform('org.junit:junit-bom:5.9.1')
    testImplementation 'org.junit.jupiter:junit-jupiter'
}